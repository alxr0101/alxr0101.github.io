<!DOCTYPE html>
<html>
<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

 

<script src="https://cdn.statically.io/gh/zenorocha/clipboard.js/v2.0.10/dist/clipboard.min.js"></script>



    <title>DSM 7 - Activate Business Backup</title>
</head>
<body>

<div style="width:800px; margin:0 auto;">


    <h2>Synology - Generate activation links for Active Backup for Business/GSuite/Office365</h2>
    
    <p> SYNOLOGY - Active Backup for ... (DSM6 and 7) </p>

    <p>Activation Steps</p>

    <p>Enter all values and click GET LINKS</p>
<p>In an incognito tab, paste the LOGIN LINK first and enter to establish session. <br>
    Then paste the selected ACTIVATION link into same address bar and hit enter to complete the activation. REPEAT for any other installed application.

    </p>
    <br>
    
    <p>HTTP type :- <input id="http_type" value="http://"></p>
    <p>IP Server:- <input id="ip_server" value="192.168.88.96"></p>
    <p>PORT:- <input id="port" value="5000"></p>
    <p>USERNAME:- <input id="username" value="admin"></p>
    <p>PASSWORD:- <input id="passwd" value="passtest"></p>
    <p>2FA One Time Code (leave BLANK if no 2FA enabled):- <input id="otp_code" value=""></p>
     

    <STRONG><br>Temporarily SET A SIMPLE PASSWORD if response does not end in "success":true"  at step 2.</br></STRONG>
    <p>SERIAL NUMBER from NAS Control Panel "Info Center" :- <input id="serialnum" value="ABC123"></p>
    <p></p>
    <p>.. <strong>Step 1 <input type="button" value="Get Links" id="newUser"></strong></p>
    
    <p>Next two steps, open a NEW INCOGNITO WINDOW and paste IN ORDER (IN THE SAME ADDRESS BAR)-- <br>COPY the Application you need to activate </p>

    <p>.... <strong>Step 2 Login link</strong>
    <button
      class="btn"
      data-clipboard-action="copy"
      data-clipboard-target="#url4login"
    >
      Copy
    </button>
    <input id="url4login" type="text" value="awaiting link" size="140"/>
    
    </p>

    
    <p>......  <strong>Step 3 Activation link</strong>

     </p>
     
     <p>

     
    <button
      class="btn"
      data-clipboard-action="copy"
      data-clipboard-target="#url4activate"
    >
      Copy for ActiveBackup for Business
    </button>
    <input id="url4activate" type="text" value="awaiting link" size="140"/>
    
    </p>  

    <p>
      <button
      class="btn"
      data-clipboard-action="copy"
      data-clipboard-target="#url4activateGSuite"
    >
      Copy for GSuite
    </button>
    <input id="url4activateGSuite" type="text" value="awaiting link" size="140"/>
    
    </p> 

    <p>
      <button
      class="btn"
      data-clipboard-action="copy"
      data-clipboard-target="#url4activateOffice365"
    >
      Copy for Office365
    </button>
    <input id="url4activateOffice365" type="text" value="awaiting link" size="140"/>
    
    </p> 


    </p>

    
 </div>

 


    <script>
    $('#newUser').click(function() {
        http_type = $("#http_type").val();
        ip_server = $("#ip_server").val();
        port = $("#port").val();
        username = encodeURI($("#username").val());
        passwd = encodeURI($("#passwd").val());
        otp_code = $("#otp_code").val();
        serialnum = $("#serialnum").val();

        let url_login = "/webapi/auth.cgi?api=SYNO.API.Auth&version=3&method=login&format=%20cookie&account=";
        let url_activate = "/webapi/entry.cgi?api=SYNO.ActiveBackup.Activation&method=set&version=1&activated=true&serial_number=";

        let url_activateGSuite="/webapi/entry.cgi?api=SYNO.ActiveBackupGSuite&method=set_activation&version=1&serial_number=";

        let url_activateOffice365="/webapi/entry.cgi?api=SYNO.ActiveBackupOffice365&method=set_activation&version=1&serial_number=";

        let url_pass = "&passwd=";
        let url_otp  = "&otp_code=";

        url_start = http_type + ip_server + ":" + port;

        url4login = url_start + url_login + username + url_pass + passwd + url_otp + otp_code;

        


        $("#url4login").val(url4login);
        console.log(url4login);
        alert("Press COPY then paste each, in order, into a new browser INCOGNITO WINDOW address bar");

        url4activate = url_start + url_activate + serialnum;
        url4activateGSuite = url_start + url_activateGSuite + serialnum;
        url4activateOffice365 = url_start + url_activateOffice365 + serialnum;

        $("#url4activate").val(url4activate);
        console.log(url4activate);
        //alert(url4activate);

        url4activate = url_start + url_activate + serialnum;



$("#url4activateGSuite").val(url4activateGSuite);
console.log(url4activateGSuite);
//alert(url4activateGSuite);

url4activateGSuite = url_start + url_activate + serialnum;

$("#url4activateOffice365").val(url4activateOffice365);
console.log(url4activateOffice365);
//alert(url4activateOffice365);



    });

    </script>

    <script>
      var clipboard = new ClipboardJS('.btn');

      clipboard.on('success', function (e) {
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
      });

      clipboard.on('error', function (e) {
        console.log(e);
      });
    </script>

     


</body>
</html>
